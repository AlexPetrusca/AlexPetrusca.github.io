const positionValuesWhite=[[0,5,0,5,0,5,0,5],[4,0,2,0,2,0,3,0],[0,3,0,1,0,2,0,4],[4,0,2,0,1,0,3,0],[0,3,0,1,0,2,0,4],[4,0,2,0,2,0,3,0],[0,3,0,3,0,3,0,4],[4,0,6,0,6,0,6,0]],positionValuesBlack=[[0,6,0,6,0,6,0,4],[4,0,3,0,3,0,3,0],[0,3,0,2,0,2,0,4],[4,0,2,0,1,0,3,0],[0,3,0,1,0,2,0,4],[4,0,2,0,1,0,3,0],[0,3,0,2,0,2,0,4],[5,0,5,0,5,0,5,0]];let thinking=!1,maxDepth=11,skipTurn=!1;function makeBestMove(){thinking=!0;let e=getAllMoves();var t;0!==e.length&&(1===e.length?performMove(e[0]):(t=whiteToMove?1:-1,negamax(e,1==t?maxDepth:maxDepth+1,-1e3,1e3,t),e.sort(function(e,t){return t.score-e.score}),performMove(e[0]),console.log(e[0].score))),thinking=!1}function negamax(e,t,o,i,n){if(skipTurn)return skipTurn=!1,-negamax(null,t,-i,-o,-n);if(0===t||whiteWin||blackWin)return n*evaluate();for(const l of null!==e?e:getAllMoves()){make(l);var a=-negamax(null,t-1,-i,-o,-n);if(o<=a&&(o=a,null!=e&&(l.score=a)),unmake(l),i<=o)break}return o}function make(t){let e=getPiece(t.fromX,t.fromY);e.x=t.toX,e.y=t.toY;var o=board[8-t.fromY][t.fromX+1];if(board[8-t.fromY][t.fromX+1]=0,board[8-t.toY][t.toX+1]=o,void 0!==t.killNum){let e=getPieceByNum(t.killNum);e.captured=!0,board[8-e.y][e.x+1]=0,lastJumpX=t.toX,lastJumpY=t.toY}("W"===e.color&&7===e.y||"B"===e.color&&0===e.y)&&(e.king=!0);t=mustJump;mustJump=!1,isWinWhite()?whiteWin=!0:isWinBlack()&&(blackWin=!0),mustJump=t,isMoveable(lastJumpX,lastJumpY)?-1!==lastJumpX&&(skipTurn=!0):(whiteToMove=!whiteToMove,lastJumpX=-1,lastJumpY=-1,mustJump=(whiteToMove?mustJumpWhite:mustJumpBlack)())}function unmake(t){let e=getPiece(t.toX,t.toY);e.x=t.fromX,e.y=t.fromY;var o=board[8-t.toY][t.toX+1];if(board[8-t.toY][t.toX+1]=0,board[8-t.fromY][t.fromX+1]=o,void 0!==t.killNum){let e=getPieceByNum(t.killNum);e.captured=!1,board[8-e.y][e.x+1]=t.killNum}e.king=t.wasKing,whiteWin=!1,blackWin=!1,setState(t.state)}function evaluate(){if(whiteWin)return 999;if(blackWin)return-999;let e=0;for(const o of whitePieces)o.captured||(e+=10,e+=positionValuesWhite[7-o.y][o.x],o.king&&(e+=5));let t=0;for(const i of blackPieces)i.captured||(t+=10,t+=positionValuesBlack[7-i.y][i.x],i.king&&(t+=5));return e-t}