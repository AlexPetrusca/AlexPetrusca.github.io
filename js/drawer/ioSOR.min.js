var extractedSORs=[],setupComplete=!1;function SOR(e,t,n){this.objName=e,this.vertices=t,this.indexes=n}function setupIOSOR(e){document.getElementById(e).addEventListener("change",readEvent),setupComplete=!0}function saveFile(e){console.log("Save"),console.log(e);var t="",n=document.createElement("a");document.body.appendChild(n),n.style="display: none",n.download=e.objName+".obj";for(var t="o "+e.objName+"\n",o=0;o<e.vertices.length;o++)t=t+"v "+e.vertices[o]+"\n";t+="usemtl (null)\ns off";for(o=0;o<e.indexes.length;o++)t=t+"f "+e.indexes[o]+"\n";var l=new Blob([t],{type:"text/plain"}),l=window.URL.createObjectURL(l);n.href=l,n.click()}function saveFileMO(e){console.log("Save"),console.log(e);var n="",t=document.createElement("a");document.body.appendChild(t),t.style="display: none",t.download=SOR.objName+".obj",e.forEach(function(e){n=n+"o "+e.objName+"\n";for(var t=0;t<e.vertices.length;t++)n=n+"v "+e.vertices[t]+"\n";n+="usemtl (null)\ns off";for(t=0;t<e.indexes.length;t++)n=n+"f "+e.indexes[t]+"\n"});e=new Blob([n],{type:"text/plain"}),e=window.URL.createObjectURL(e);t.href=e,t.click()}function readFile(){if(null!=extractedSORs&&1==setupComplete)return alert(extractedSORs.objName),extractedSORs;setupComplete?alert("Error File Not Selected"):alert("Please ensure you call setupIOSOR('ID OF FILE INPUT')")}function readEvent(e){extractedSORs=[];var t=e.target.files[0],o=new SOR("",[],[]);t?((e=new FileReader).onload=function(e){for(var t=e.target.result,n="";!((n=t.substr(0,t.indexOf("\n"))).length<=0);)"o"==n.charAt(0)&&(""===o.objName?o.objName=n.substr(n.indexOf(" ")+1):(extractedSORs.push(o),console.log("Extracted"),console.log(o),(o=new SOR("",[],[])).objName=n.substr(n.indexOf(" ")+1))),"v"==n.charAt(0)&&o.vertices.push(parseFloat(n.substr(n.indexOf(" ")+1))),"f"==n.charAt(0)&&o.indexes.push(parseFloat(n.substr(n.indexOf(" ")+1))),t=t.substr(t.indexOf("\n")+1);console.log("Extracted"),console.log(o),extractedSORs.push(o)},e.readAsText(t)):alert("Failed to load file")}